<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<link rel="Stylesheet" type="text/css" href="style.css">
<title>linux学习笔记 － 常用API</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head>
<body>

<h1>目录</h1>
<div class="toc">
<ul>
<li><a href="#toc_0.0.1">smp_processor_id()</a>
<li><a href="#toc_0.0.2">ioremap_nocache</a>
<li><a href="#toc_0.0.3">time</a>
<ul>
<li><a href="#toc_0.0.3.1">local_clock</a>
<li><a href="#toc_0.0.3.2">ktime_get</a>
</ul>
</ul>
</ul>
</ul>
</div>
<hr />

<h3 id="toc_0.0.1">smp_processor_id()</h3>
<pre>
获取当前在哪个CPU上
</pre>

<h3 id="toc_0.0.2">ioremap_nocache</h3>
<pre>
phys_addr_t phy_sec_debug_log_struct = 0x86A00000;
/* we should meet to align to 1M regarding for  size */
size_t phy_sec_debug_log_struct_size = 0x100000;
static void map_noncached_sched_log_buf(void)
{
    void __iomem *base=0;

    base = ioremap_nocache(phy_sec_debug_log_struct ,phy_sec_debug_log_struct_size );
    psec_debug_log = base;
}

void __sec_debug_task_log(int cpu, struct task_struct *task)
{
    unsigned i;

    i = atomic_inc_return(&amp;task_log_idx[cpu]) &amp; (SCHED_LOG_MAX - 1);
    psec_debug_log-&gt;task[cpu][i].time = cpu_clock(cpu);
    strcpy(psec_debug_log-&gt;task[cpu][i].comm, task-&gt;comm);
    psec_debug_log-&gt;task[cpu][i].pid = task-&gt;pid;
}
</pre>

<h3 id="toc_0.0.3">time</h3>
<h4 id="toc_0.0.3.1">local_clock</h4>
<pre>
u64 local_clock(void)
</pre>

<h4 id="toc_0.0.3.2">ktime_get</h4>
<pre>
ktime_t ktime_get(void)
</pre>

</body>
</html>
