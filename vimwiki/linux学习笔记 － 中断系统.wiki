%toc 目录

----
== 中断向量表 ==
|*地址*|*异常种类*|
|FFFF0000|复位|
|FFFF0004|未定义指令|
|FFFF0008|软中断（swi）|
|FFFF000C|Prefetch abort|
|FFFF0010|Data abort|
|FFFF0014|保留|
|FFFF0018|IRQ|
|FFFF001C|FIQ|
该向量表定义在kernel/arch/arm/kernel/entry-armv.S

----
== GIC ==
=== 基本架构图 ===
{{local:images/gic.png}}</BR>
{{{
0~31是PPI和SGI中断，是给特定CPU的
}}}

* Distributor
{{{
中断enable或者disable的控制。
控制将当前优先级最高的中断事件分发到一个或者一组CPU interface。
优先级控制。
interrupt属性设定。例如是level-sensitive还是edge-triggered
interrupt group的设定
}}}

* CPU interface
{{{
enable或者disable CPU interface向连接的CPU assert中断事件。
ackowledging中断。
中断处理完毕的通知。
设定priority mask。
设定preemption的策略
在多个中断事件同时到来的时候，选择一个优先级最高的通知processor
}}}

=== 调试技巧 ===
{{{
SPRD系统中
0x12001000	是Distributor address
0x12002000	是CPU interface address range

lookat -l50 0x12001800，可以看到target寄存器的值，当前除了timer外，都是给cpu0的

/proc/irq/<irq>节点，可以设置让哪个cpu响应
echo 1 > smp_affinity_list，可以让cpu1响应该中断
}}}

=== Code ===
{{{
kernel/drivers/irqchip/irq-gic.c
kernel/drivers/irqchip/irq-gic-common.c
kernel/drivers/platform/sprd/common.c
kernel/include/linux/irqchip/arm-gic.h
}}}

=== 参考资料 ===
[[local:files/gic_architecture_specification.pdf|gic_architecture_specification.pdf]]<BR>

----
== 参考资料 ==
[[http://www.wowotech.net/sort/irq_subsystem|中断子系统]]<BR>
[[http://blog.csdn.net/DroidPhone/article/category/1118447|Linux中断子系统]]<BR>
